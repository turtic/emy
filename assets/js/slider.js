let page0 = `
<body id="app" class="background-color-dark full-screen">
<div class="container screens">
  <h5>@EMY</h5>
  <div class="row">
    <div
      class="col-12 offset-md-1 col-md-11 offset-xl-0 col-xl-12 screen-1"
    >
      <h2>Get Paid - Simple as that!</h2>
      <h3>
        Accept credit card, bank transfer or blockchain payment in seconds.
        Instant confirmation. No hassle.
      </h3>
      <div class="yourhandle">
        <button id="reserve-btn">Reserve<i class="icon-arrow"></i></button>
        <label for="handle">@</label>
        <input id="handleReserve" type="text" placeholder="yourhandle" />
      </div>
      <p>
        <span>Emyapp is twitter for payments.</span> All you need is an
        emyapp handle.
      </p>
    </div>
  </div>
</div>`;

let page1 = `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-md-8 col-lg-7">
    <div class="text-box box-active">
      <h2>Create your Emyapp handle</h2>
      <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
        Emmyapp Profile.</p>
    </div>
    <div class="text-box">
      <h2>Share your Emyapp profile</h2>
      <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
        card, Bank transfer of even Bitcoin.</p>
    </div>
    <div class="text-box">
      <h2>Get payed instantly</h2>
      <p>As soon as you have your Emyapp handle you can accept payments</p>
    </div>
  </div>
  <div class="col-md-4 col-lg-5">
    <picture>
      <source
        srcset="./assets/media/tablet/images/landingpage_4.png"
        media="(max-width: 922px)"
      />
      <img
        class="img-fluid"
        src="./assets/media/desktop/images/landingpage_4.png"
        alt="emy phone"
      />
    </picture>
  </div>
</div>
</div>`;

let page2 = `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-md-8 col-lg-7">
    <div class="text-box">
      <h2>Create your Emyapp handle</h2>
      <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
        Emmyapp Profile.</p>
    </div>
    <div class="text-box box-active">
      <h2>Share your Emyapp profile</h2>
      <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
        card, Bank transfer of even Bitcoin.</p>
    </div>
    <div class="text-box">
      <h2>Get payed instantly</h2>
      <p>As soon as you have your Emyapp handle you can accept payments</p>
    </div>
  </div>
  <div class="col-md-4 col-lg-5">
    <picture>
      <source
        srcset="./assets/media/tablet/images/landingpage_5.png"
        media="(max-width: 922px)"
      />
      <img
        class="img-fluid"
        src="./assets/media/desktop/images/landingpage_5.png"
        alt="emy phone"
      />
    </picture>
  </div>
</div>
</div>`;

let page3 = `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-md-8 col-lg-7">
    <div class="text-box ">
      <h2>Create your Emyapp handle</h2>
      <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
        Emmyapp Profile.</p>
    </div>
    <div class="text-box ">
      <h2>Share your Emyapp profile</h2>
      <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
        card, Bank transfer of even Bitcoin.</p>
    </div>
    <div class="text-box box-active">
      <h2>Get payed instantly</h2>
      <p>As soon as you have your Emyapp handle you can accept payments</p>
    </div>
  </div>
  <div class="col-md-4 col-lg-5">
  <picture>
    <source
      srcset="./assets/media/tablet/images/landingpage_6.png"
      media="(max-width: 922px)"
    />
    <img
      class="img-fluid"
      src="./assets/media/desktop/images/landingpage_6.png"
      alt="emy phone"
    />
    </picture>
  </div>
</div>
</div>`;

let smallPage0 = `
<body id="app" class="background-color-dark full-screen">
<div class="container screens">
  <h5>@EMY</h5>
  <div class="row">
    <div
      class="col-12 offset-md-1 col-md-11 offset-xl-0 col-xl-12 screen-1"
    >
      <h2>Get Paid - Simple as that!</h2>
      <h3>
        Accept credit card, bank transfer or blockchain payment in seconds.
        Instant confirmation. No hassle.
      </h3>
      <div class="yourhandle">
        <button id="reserve-btn">Reserve<i class="icon-arrow"></i></button>
        <label for="handle">@</label>
        <input id="handleReserve" type="text" placeholder="yourhandle" />
      </div>
      <p>
        <span>Emyapp is twitter for payments.</span> All you need is an
        emyapp handle.
      </p>
    </div>
  </div>
</div>`;

let smallPage1= `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-12">
    <div class="text-box box-active">
      <h2>Create your Emyapp handle</h2>
      <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
        Emmyapp Profile.</p>
    </div>
    <div class="col-8 offset-2 img-divider-576 ">
    <img src="./assets/media/mobile/images/landingpage_4.png" alt="" srcset="">
    </div>

    <div class="text-box img-divider">
      <h2>Share your Emyapp profile</h2>
      <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
        card, Bank transfer of even Bitcoin.</p>
    </div>
  </div>
</div>
</div>`;

let smallPage2= `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-12">
    <div class="text-box box-active">
      <h2>Share your Emyapp profile</h2>
      <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
        card, Bank transfer of even Bitcoin.</p>
    </div>
    <div class="col-8 offset-2 img-divider-576">
    <img src="./assets/media/mobile/images/landingpage_5.png" alt="" srcset="">
    </div>
    <div class="text-box img-divider">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
    </div>
  </div>
</div>
</div>`;

let smallPage3= `
<div class="container screens">
<div class="row screen-2 d-flex">
  <div class="col-12">
    <div class="text-box box-active">
      <h2>Get payed instantly</h2>
      <p>As soon as you have your Emyapp handle you can accept payments</p>
    </div>
    <div class="col-8 offset-2 img-divider-576">
      <img src="./assets/media/mobile/images/landingpage_6.png" alt="" srcset="">
    </div>
  </div>
</div>
</div>`

const htmlPages = [page0, page1, page2, page3];

const htmlSmallPages = [smallPage0, smallPage1, smallPage2, smallPage3];


let slide = 0;
let pages = [];

function changeLink(oldHtml, newHTML) {
  let oldPath = window.location.pathname;
  let newPath;
  if (oldPath.includes(oldHtml)) {
    newPath = oldPath.replace(oldHtml, newHTML);
  } else {
    newPath = oldPath + newHTML;
  }

  return newPath;
}

function inputLogic() {
  if (document.getElementById("reserve-btn")) {
    document
      .getElementById("reserve-btn")
      .addEventListener("click", function() {
        console.log("button pressed");
        let nickName = document.getElementById("handleReserve").value;
        localStorage.setItem("userHandle", nickName);
        window.location.pathname = changeLink("index.html", "signup.html");
      });

    var input = document.getElementById("handleReserve");
    input.addEventListener("keyup", function(event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById("reserve-btn").click();
      }
    });
    console.log("Helloooo!? Input!?");
  }
}

function screenWidthCheck(x) {
  if (x.matches) {
    // If media query matches
    pages = htmlSmallPages;
  } else {
    pages = htmlPages;
  }
  console.log("render");
  render();
}

var x = window.matchMedia("(max-width: 767px)");
screenWidthCheck(x); // Call listener function at run time
x.addListener(screenWidthCheck); // Attach listener function on state changes

function render() {
  switch (slide) {
    case 0:
      changeScreen(pages[0]);
      inputLogic();
      break;
    case 1:
      changeScreen(pages[1]);
      break;
    case 2:
      changeScreen(pages[2]);
      break;
    case 3:
      changeScreen(pages[3]);
      break;
    case 4:
      window.location.pathname = changeLink("index.html", "main.html");
      break;
    default:
      changeScreen(pages[0]);
  }
}

function changeScreen(page) {
  document.getElementById("app").innerHTML = page;
}

function debounce(callback, wait, immediate = false) {
  let timeout = null;

  return function() {
    const callNow = immediate && !timeout;
    const next = () => callback.apply(this, arguments);

    clearTimeout(timeout);
    timeout = setTimeout(next, wait);

    if (callNow) {
      next();
    }
  };
}

const handleScroll = debounce(
  event => {
    if (event.deltaY < 0) {
      console.log("scrolling up");
      // on scroll up
      if (slide > 0) {
        slide = slide - 1;
        render();
      }
    }
    if (event.deltaY > 0) {
      console.log("scrolling down");
      //on scroll down
      if (slide < 4) {
        slide = slide + 1;
        render();
      }
    }
  },
  500,
  true
);

window.addEventListener("wheel", event => {
  handleScroll(event);
});

//  swipe
document.addEventListener("touchstart", startTouch, false);
document.addEventListener("touchmove", moveTouch, false);

// Swipe Up / Down / Left / Right
var initialX = null;
var initialY = null;

function startTouch(e) {
  initialX = e.touches[0].clientX;
  initialY = e.touches[0].clientY;
}

function moveTouch(e) {
  if (initialX === null) {
    return;
  }

  if (initialY === null) {
    return;
  }

  var currentX = e.touches[0].clientX;
  var currentY = e.touches[0].clientY;

  var diffX = initialX - currentX;
  var diffY = initialY - currentY;

  if (Math.abs(diffX) > Math.abs(diffY)) {
    // sliding horizontally
    if (diffX > 0) {
      // swiped left
    } else {
      // swiped right
    }
  } else {
    // sliding vertically
    if (diffY > 0) {
      // swiped up
      if (slide < 4) {
        slide = slide + 1;
        render();
      }
    } else {
      // swiped down

      if (slide > 0) {
        slide = slide - 1;
        render();
      }
    }
  }

  initialX = null;
  initialY = null;

  e.preventDefault();
}

console.log("hello");
