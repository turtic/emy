"use strict";

var page0 =
  '\n<body id="app" class="background-color-dark full-screen">\n<div class="container screens">\n <div class="row">\n    <div\n      class="col-12 offset-md-1 col-md-11 offset-xl-0 col-xl-12 screen-1"\n    >\n      <h2>Get Paid - Simple as that!</h2>\n      <h3>\n        Accept credit card, bank transfer or blockchain payment in seconds.\n        Instant confirmation. No hassle.\n      </h3>\n      <div class="yourhandle">\n        <button id="reserve-btn">Reserve<i class="icon-arrow"></i></button>\n        <label for="handle">@</label>\n        <input id="handleReserve" type="text" placeholder="yourhandle" />\n      </div>\n      <p>\n        <span>Emyapp is twitter for payments.</span> All you need is an\n        emyapp handle.\n      </p>\n    </div>\n  </div>\n</div>';
let page1 = `
  <div class="container screens">
  <div class="row screen-2 d-flex">
    <div class="col-md-8 col-lg-7">
      <div class="text-box box-active animate-me">
        <h2>Create your Emyapp handle</h2>
        <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
          Emmyapp Profile.</p>
      </div>
      <div class="text-box">
        <h2>Share your Emyapp profile</h2>
        <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
      <div class="text-box">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-5">
      <picture>
        <source
          srcset="./assets/media/tablet/images/landingpage_3.png"
          media="(max-width: 922px)"
        />
        <img
          class="img-fluid animate-me-img"
          src="./assets/media/desktop/images/landingpage_3.png"
          alt="emy phone"
        />
      </picture>
    </div>
  </div>
  </div>`;
  
  let page2 = `
  <div class="container screens">
  <div class="row screen-2 d-flex">
    <div class="col-md-8 col-lg-7">
      <div class="text-box box-active animate-me">
        <h2>Create your Emyapp handle</h2>
        <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
          Emmyapp Profile.</p>
      </div>
      <div class="text-box">
        <h2>Share your Emyapp profile</h2>
        <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
      <div class="text-box">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-5">
      <picture>
        <source
          srcset="./assets/media/tablet/images/landingpage_4.png"
          media="(max-width: 922px)"
        />
        <img
          class="img-fluid animate-me-img"
          src="./assets/media/desktop/images/landingpage_4.png"
          alt="emy phone"
        />
      </picture>
    </div>
  </div>
  </div>`;
  
let page3 = `
  <div class="container screens">
  <div class="row screen-2 d-flex">
    <div class="col-md-8 col-lg-7">
      <div class="text-box ">
        <h2>Create your Emyapp handle</h2>
        <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
          Emmyapp Profile.</p>
      </div>
      <div class="text-box box-active animate-me">
        <h2>Share your Emyapp profile</h2>
        <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
      <div class="text-box ">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-5">
    <picture>
      <source
        srcset="./assets/media/tablet/images/landingpage_5.png"
        media="(max-width: 922px)"
      />
      <img
        class="img-fluid animate-me-img"
        src="./assets/media/desktop/images/landingpage_5.png"
        alt="emy phone"
      />
      </picture>
    </div>
  </div>
  </div>`;
  let page4 = `
  <div class="container screens">
  <div class="row screen-2 d-flex">
    <div class="col-md-8 col-lg-7">
      <div class="text-box ">
        <h2>Create your Emyapp handle</h2>
        <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
          Emmyapp Profile.</p>
      </div>
      <div class="text-box ">
        <h2>Share your Emyapp profile</h2>
        <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
      <div class="text-box box-active animate-me">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div>
    </div>
    <div class="col-md-4 col-lg-5">
    <picture>
      <source
        srcset="./assets/media/tablet/images/landingpage_6.png"
        media="(max-width: 922px)"
      />
      <img
        class="img-fluid animate-me-img"
        src="./assets/media/desktop/images/landingpage_6.png"
        alt="emy phone"
      />
      </picture>
    </div>
  </div>
  </div>`;  

  let smallPage0 = `
  <div class="container screens">
    <div class="row">
      <div
        class="col-12 offset-md-1 col-md-11 offset-xl-0 col-xl-12 screen-1"
      >
        <h2>Get Paid - Simple as that!</h2>
        <h3>
          Accept credit card, bank transfer or blockchain payment in seconds.
          Instant confirmation. No hassle.
        </h3>
        <div class="yourhandle">
          <button id="reserve-btn">Reserve<i class="icon-arrow"></i></button>
          <label for="handle">@</label>
          <input id="handleReserve" type="text" placeholder="yourhandle" />
        </div>
        <p>
          <span>Emyapp is twitter for payments.</span> All you need is an
          emyapp handle.
        </p>
      </div>
    </div>
  </div>`;
  
  let smallPage1= `
  <div class="container screens">
  <div class="row screen-2 d-flex fade-in-screen">
    <div class="col-12">
      <div class="text-box box-active">
        <h2>Create your Emyapp handle</h2>
        <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
          Emmyapp Profile.</p>
      </div>
      <div class="col-8 offset-2 img-divider-576 ">
      <img src="./assets/media/mobile/images/landingpage_3.png" alt="emy phone">
      </div>
  
      <div class="text-box img-divider">
        <h2>Share your Emyapp profile</h2>
        <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
    </div>
  </div>
  </div>`;
  
  let smallPage2= `
  <div class="container screens">
  <div class="row screen-2 d-flex fade-in-screen">
    <div class="col-12">
      <div class="text-box box-active">
      <h2>Create your Emyapp handle</h2>
      <p>Every Emyapp handle is unique and is at the same time your own Profile for your payments - your unique
        Emmyapp Profile.</p>
      </div>
      <div class="col-8 offset-2 img-divider-576">
      <img src="./assets/media/mobile/images/landingpage_4.png" alt="" srcset="">
      </div>
      <div class="text-box img-divider">
          <h2>Share your Emyapp profile</h2>
          <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
    </div>
  </div>
  </div>`;
  
  let smallPage3= `
  <div class="container screens">
  <div class="row screen-2 d-flex fade-in-screen">
    <div class="col-12">
      <div class="text-box box-active">
      <h2>Share your Emyapp profile</h2>
          <p>Share your Emyapp Profile if you want to get paid. Everyone visiting your profile can pay you with credit
          card, Bank transfer of even Bitcoin.</p>
      </div>
      <div class="col-8 offset-2 img-divider-576">
        <img src="./assets/media/mobile/images/landingpage_5.png" alt="" srcset="">
      </div>
      <div class="col-12">
      <div class="text-box">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div
    </div>
  </div>
  </div>`
  
  let smallPage4= `
  <div class="container screens">
  <div class="row screen-2 d-flex fade-in-screen">
    <div class="col-12">
      <div class="text-box box-active">
        <h2>Get payed instantly</h2>
        <p>As soon as you have your Emyapp handle you can accept payments</p>
      </div>
      <div class="col-8 offset-2 img-divider-576">
        <img src="./assets/media/mobile/images/landingpage_6.png" alt="" srcset="">
      </div>
    </div>
  </div>
  </div>`

var htmlPages = [page0, page1, page2, page3, page4];
var htmlSmallPages = [smallPage0, smallPage1, smallPage2, smallPage3, smallPage4];
var slide = 0;
var pages = [];

function changeLink(oldHtml, newHTML) {
  var oldPath = window.location.pathname;
  var newPath;

  if (oldPath.indexOf(oldHtml)) {
    newPath = oldPath.replace(oldHtml, newHTML);
  } else {
    newPath = oldPath + newHTML;
  }
  console.log(newPath);
  
  return newPath;
}

function inputLogic() {
  if (document.getElementById("reserve-btn")) {
    document
      .getElementById("reserve-btn")
      .addEventListener("click", function() {
        var nickName = document.getElementById("handleReserve").value;
        localStorage.setItem("userHandle", nickName);
        window.location.pathname = changeLink("index.html", "signup.html");
      });
    var input = document.getElementById("handleReserve");
    input.addEventListener("keyup", function(event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById("reserve-btn").click();
      }
    });
  }
}

// check width
function screenWidthCheck(x) {
  if (x.matches) {
    // If media query matches
    pages = htmlSmallPages;
  } else {
    pages = htmlPages;
  }
  render();
}

var x = window.matchMedia("(max-width: 767px)");
screenWidthCheck(x); // Call listener function at run time

x.addListener(screenWidthCheck); // Attach listener function on state changes

function render() {
  switch (slide) {
    case 0:
      changeScreen(pages[0]);
      document.querySelector(".reserve-index-btn").style.display = "none";
      document.querySelector(".reserve-index-btn").style.opacity = 0;
      inputLogic();
      break;

    case 1:
      changeScreen(pages[1]);
      document.querySelector(".reserve-index-btn").style.display = "flex";
      $(".reserve-index-btn").fadeTo(400, 1);
      break;

    case 2:
      changeScreen(pages[2]);
      break;

    case 3:
      changeScreen(pages[3]);
      break;

    case 4:
    changeScreen(pages[4]);
    break

    case 5:
      window.location.pathname = changeLink("index.html", "main.html");
      break;

    default:
      changeScreen(pages[0]);
  }
}

function changeScreen(page) {
  $(".fade-in-screen").fadeOut();
  $(".animate-me-img").fadeOut();
  $(".animate-me").fadeTo(400, 0.2);
  setTimeout(function(){ $("#app").html(page); }, 400);
 
  // document.getElementById("app").innerHTML = page;
}
// debounce
function debounce(callback, wait) {
  var immediate =
    arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var timeout = null;
  return function() {
    var _this = this,
      _arguments = arguments;

    var callNow = immediate && !timeout;

    var next = function next() {
      return callback.apply(_this, _arguments);
    };

    clearTimeout(timeout);
    timeout = setTimeout(next, wait);

    if (callNow) {
      next();
    }
  };
}
// scroll
var handleScroll = debounce(
  function(event) {
    if (event.deltaY < 0) {
      // on scroll up
      if (slide > 0) {
        slide = slide - 1;
        render();
      }
    }
    if (event.deltaY > 0) {
      //on scroll down
      if (slide < 5) {
        slide = slide + 1;
        render();
      }
    }
  },
  800,
  true
);
window.addEventListener("wheel", function(event) {
  handleScroll(event);
});

//  swipe
document.addEventListener("touchstart", startTouch, false);
document.addEventListener("touchmove", moveTouch, false); // Swipe Up / Down / Left / Right

var initialX = null;
var initialY = null;

function startTouch(e) {
  initialX = e.touches[0].clientX;
  initialY = e.touches[0].clientY;
}

function moveTouch(e) {
  if (initialX === null) {
    return;
  }

  if (initialY === null) {
    return;
  }

  var currentX = e.touches[0].clientX;
  var currentY = e.touches[0].clientY;
  var diffX = initialX - currentX;
  var diffY = initialY - currentY;

  if (Math.abs(diffX) > Math.abs(diffY)) {
    // sliding horizontally
    if (diffX > 0) {
      // swiped left
    } else {
      // swiped right
    }
  } else {
    // sliding vertically
    if (diffY > 0) {
      // swiped up
      if (slide < 5) {
        slide = slide + 1;
        render();
      }
    } else {
      // swiped down
      if (slide > 0) {
        slide = slide - 1;
        render();
      }
    }
  }

  initialX = null;
  initialY = null;
  e.preventDefault();
}
